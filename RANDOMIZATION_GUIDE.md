# ğŸ² Randomization System Guide

## Overview
æ¯æ¬¡ç”Ÿæˆéƒ½ä¼šäº§ç”Ÿç‹¬ç‰¹çš„åƒç´ ç”Ÿç‰©,å³ä½¿ä½¿ç”¨ç›¸åŒçš„æè¿°è¯ã€‚ç³»ç»Ÿé€šè¿‡æ—¶é—´æˆ³å’Œå¤šç»´åº¦éšæœºå‚æ•°ç¡®ä¿é«˜åº¦å¤šæ ·æ€§ã€‚

## ğŸ”¢ Random Seed System

### Time-based Seeding
```typescript
const randomSeed = Date.now() + Math.random() * 10000 + i * 1000;
const variantDesc = `${description}_${randomSeed}`;
```

**æ•ˆæœ**: æ¯æ¬¡ç‚¹å‡»ç”Ÿæˆ,å³ä½¿æè¿°ç›¸åŒ,ä¹Ÿä¼šäº§ç”Ÿå®Œå…¨ä¸åŒçš„ç”Ÿç‰©

## ğŸ¨ Visual Randomization

### 1. å²è±å§†å‹ (Slime Type)

**Body Variations**:
- Size: 9-11 pixels radius (3ç§å¤§å°)
- Squish Factor: 0.8-1.2 (æ‰å¹³ â†” åœ†æ¶¦)
- Shadow Width: 6-8 pixels

**Features**:
- Highlight Position: éšæœºåç§»3x3åŒºåŸŸ
- Eye Vertical Position: Â±1 pixel
- Mouth Styles: 3ç§
  * Style 0: ç›´çº¿å˜´ `â€”â€”`
  * Style 1: å¾®ç¬‘ `âŒ£`
  * Style 2: å°åœ†å£ `â—‹`

**Example Variations**:
```
[åœ†èƒ–å²è±å§†] vs [æ‰å¹³å²è±å§†] vs [ä¸­ç­‰å²è±å§†]
  â—â—â—              â–¬â–¬â–¬             â—¯â—¯â—¯
  â—â—â—             â–¬â–¬â–¬â–¬            â—¯â—¯â—¯
  â—â—â—            â–¬â–¬â–¬â–¬â–¬           â—¯â—¯â—¯â—¯
```

### 2. è˜‘è‡å‹ (Mushroom Type)

**Body Variations**:
- Leg Count: 3-4æ¡è…¿
- Leg Length: 10-12 pixels (æ¯æ¡è…¿ç‹¬ç«‹éšæœº)
- Leg Thickness: 1-2 pixels (50%æ¦‚ç‡åŠ ç²—)
- Head Size: 7-8 pixels radius

**Features**:
- Spot Count: 3-6ä¸ªæ–‘ç‚¹
- Spot Position: åœ†å‘¨åˆ†å¸ƒ+éšæœºåç§»
- Spot Size: 1-2 pixels radius
- Eye Position: å‚ç›´Â±1 pixel

**Example Variations**:
```
[3è…¿ç»†é•¿] vs [4è…¿ç²—çŸ­] vs [3è…¿å¸¦å¤§æ–‘ç‚¹]
   â—â—‘          â—â—‘â—          â—â—â—‘
  |||||       â–â–ˆâ–Œâ–â–ˆâ–Œ        ||||
  | | |       â–â–ˆâ–Œâ–â–ˆâ–Œ        | ||
```

### 3. å¹½çµå‹ (Ghost Type)

**Body Variations**:
- Width: 5-7 pixels
- Height: 7-9 pixels
- Wave Styles: 3ç§åº•éƒ¨å½¢çŠ¶
  * Style 0: æ­£å¼¦æ³¢ `âˆ¿âˆ¿âˆ¿` (æµç•…æ³¢æµª)
  * Style 1: é”¯é½¿æ³¢ `âˆ§âˆ¨âˆ§` (å°–é”é”¯é½¿)
  * Style 2: æ–¹æ³¢ `â–”_â–”` (æ–¹å—æ³¢æµª)

**Features**:
- Glow Size: 3-4 pixels (åŠé€æ˜åŒºåŸŸ)
- Glow Position: éšæœºåç§»3åƒç´ èŒƒå›´
- Eye Position: å‚ç›´Â±2 pixels

**Example Variations**:
```
[æµç•…å¹½çµ] vs [é”¯é½¿å¹½çµ] vs [æ–¹å—å¹½çµ]
   â— â—¡â—          âˆ§âˆ¨âˆ§           â–”_â–”
  (â—‰ â—‰)       (â—‰ â—‰)         (â—‰ â—‰)
  âˆ¿âˆ¿âˆ¿âˆ¿        âˆ§âˆ¨âˆ§âˆ¨          â–”_â–”_
```

### 4. æ¶é­”å‹ (Demon Type)

**Body Variations**:
- Body Size: 5-7 pixels
- Wing Size: 3-4 pixels
- Wing Spread: 10-12 pixels
- Wing Styles: 2ç§
  * Style 0: åœ†å½¢ç¿…è†€ (æŸ”å’Œ)
  * Style 1: å°–è§’ç¿…è†€ (é”‹åˆ©)

**Horn Variations** (3ç§æ ·å¼):
- Style 0: ç›´è§’ `||` (æ–¹æŸ±å½¢)
- Style 1: å°–è§’ `âˆ§âˆ§` (é”¥å½¢)
- Style 2: å¼¯æ›² `âŒ’âŒ’` (æœˆç‰™å½¢)

**Parameters**:
- Horn Height: 3-5 pixels
- Horn Spacing: 2-3 pixels
- Eye Position: å‚ç›´Â±2 pixels

**Example Variations**:
```
[åœ†ç¿…ç›´è§’] vs [å°–ç¿…å°–è§’] vs [åœ†ç¿…å¼¯è§’]
  | |          âˆ§âˆ§           âŒ’âŒ’
 )â—â—â—(        /â—â—â—\        )â—â—â—(
 â–“â–“â–“â–“â–“       â—£â—£â—£â—£â—£       â–“â–“â–“â–“â–“
```

### 5. çœ¼ç›ç³»ç»Ÿ (Eye Variations)

**3ç§çœ¼ç›é£æ ¼**:

**Style 0: æ ‡å‡†åœ†çœ¼** (Standard Round Eyes)
- Size: 1-2 pixels
- Spacing: 3-4 pixels
- Pupil Direction: 5ç§
  * 0: æ­£ä¸­ `â—‰`
  * 1: å‘å·¦ `â—`
  * 2: å‘å³ `â—‘`
  * 3: å‘ä¸Š `â—‰Ì‡`
  * 4: å‘ä¸‹ `â—‰Ì£`
- Highlight: å·¦ä¸Šè§’ç™½ç‚¹

**Style 1: æ„¤æ€’çœ¼** (Angry Eyes)
- æ–œçº¿æ ·å¼ `><`
- æ— çœ¼ç™½
- 3åƒç´ æ–œçº¿

**Style 2: å¯çˆ±å¤§çœ¼** (Cute Big Eyes)
- æ›´å¤§çš„çœ¼ç™½åŒºåŸŸ (5åƒç´ åœ†)
- 2x2ç³å­”
- åŒåƒç´ é«˜å…‰

**Random Distribution**:
```
33% Standard + 33% Angry + 34% Cute
æ¯æ¬¡ç”Ÿæˆéƒ½ä¼šéšæœºé€‰æ‹©ä¸€ç§
```

## ğŸ”Š Audio Randomization

### Category Matching System

**Keyword â†’ Category Mapping**:
```typescript
{
  roar: ['aggressive', 'beast', 'å’†å“®'] â†’ 3 files
  scream: ['angry', 'å°–å«'] â†’ 1 file
  growl: ['calm', 'low', 'ä½å¼'] â†’ 3 files
  laugh: ['troll', 'ç¬‘'] â†’ 1 file
  cry: ['hurt', 'å“­'] â†’ 1 file
}
```

### Multi-Keyword Support
å¦‚æœæè¿°åŒ…å«å¤šä¸ªå…³é”®è¯:
```
"angry beast" â†’ åŒ¹é… roar + scream
â†’ éšæœºé€‰æ‹©å…¶ä¸­ä¸€ä¸ªç±»åˆ«
â†’ å†ä»è¯¥ç±»åˆ«éšæœºé€‰ä¸€ä¸ªéŸ³é¢‘
```

### Fallback Mechanism
æ— åŒ¹é…å…³é”®è¯æ—¶:
```
éšæœºé€‰æ‹© 5 ä¸ªç±»åˆ«ä¸­çš„ä»»æ„ä¸€ä¸ª
â†’ å†ä»è¯¥ç±»åˆ«éšæœºé€‰æ‹©
```

### Time-based Selection
```typescript
const audioIndex = Math.floor((seed * 7 + Date.now()) % audioList.length);
```
å³ä½¿åŒä¸€ç±»åˆ«,æ¯æ¬¡ä¹Ÿå¯èƒ½é€‰æ‹©ä¸åŒçš„éŸ³é¢‘æ–‡ä»¶

## ğŸ“Š Randomization Statistics

### å•ä¸ªç”Ÿç‰©çš„å¯èƒ½ç»„åˆæ•°

**å²è±å§†å‹**:
- å¤§å°: 3ç§
- æ‰å¹³åº¦: 40ç§
- å˜´å·´: 3ç§
- çœ¼ç›: 3ç§æ ·å¼ Ã— 5ç§æ–¹å‘ = 15ç§
- **æ€»è®¡**: 3 Ã— 40 Ã— 3 Ã— 15 = **5,400** ç§ç»„åˆ

**è˜‘è‡å‹**:
- è…¿æ•°: 2ç§
- å¤´å¤§å°: 2ç§
- æ–‘ç‚¹: 4ç§æ•°é‡ Ã— ä¸åŒä½ç½® â‰ˆ 100ç§
- çœ¼ç›: 15ç§
- **æ€»è®¡**: 2 Ã— 2 Ã— 100 Ã— 15 = **60,000** ç§ç»„åˆ

**å¹½çµå‹**:
- å®½åº¦: 3ç§
- é«˜åº¦: 3ç§
- æ³¢æµªæ ·å¼: 3ç§
- å‘å…‰: å¤šç§ä½ç½®
- çœ¼ç›: 15ç§
- **æ€»è®¡**: 3 Ã— 3 Ã— 3 Ã— 10 Ã— 15 = **4,050** ç§ç»„åˆ

**æ¶é­”å‹**:
- èº«ä½“: 3ç§
- ç¿…è†€æ ·å¼: 2ç§
- ç¿…è†€å¤§å°: 2 Ã— 3 = 6ç§
- è§’æ ·å¼: 3ç§
- è§’å‚æ•°: 3 Ã— 2 = 6ç§
- çœ¼ç›: 15ç§
- **æ€»è®¡**: 3 Ã— 6 Ã— 3 Ã— 6 Ã— 15 = **4,860** ç§ç»„åˆ

### éŸ³é¢‘éšæœºæ€§
- 9ä¸ªä¸åŒçš„éŸ³é¢‘æ–‡ä»¶
- 5ç§åŒ¹é…ç­–ç•¥
- æ—¶é—´æˆ³å½±å“é€‰æ‹©
- **ç»“æœ**: å‡ ä¹æ¯æ¬¡éƒ½ä¸åŒ

## ğŸ¯ Usage Tips

### è·å¾—ç‰¹å®šé£æ ¼
è™½ç„¶æ˜¯éšæœºçš„,ä½†å…³é”®è¯ä»ä¼šå½±å“:
- **é¢œè‰²**: ä½¿ç”¨ 'fire', 'ice', 'green' ç­‰
- **éŸ³æ•ˆ**: ä½¿ç”¨ 'roar', 'laugh', 'cry' ç­‰

### å¤šæ¬¡ç”Ÿæˆ
æƒ³è¦ç‰¹å®šæ ·å¼:
1. å¤šæ¬¡ç‚¹å‡»ç”Ÿæˆ (æ¯æ¬¡4ä¸ªå˜ä½“)
2. ä»ä¸­é€‰æ‹©æœ€å–œæ¬¢çš„
3. ç‚¹å‡»åˆ†äº«ä¿å­˜

### æ‰¹é‡ç”Ÿæˆå»ºè®®
ä¸€æ¬¡ç”Ÿæˆ4ä¸ªå˜ä½“å·²ç»æä¾›äº†å¾ˆå¥½çš„å¤šæ ·æ€§:
- å¯èƒ½å‡ºç°ä¸åŒçš„ç±»å‹
- å¯èƒ½æœ‰ä¸åŒçš„è£…é¥°
- çœ¼ç›è¡¨æƒ…å¯èƒ½ä¸åŒ
- éŸ³é¢‘ä¹Ÿä¼šä¸åŒ

## ğŸ”§ Technical Implementation

### Random Number Generator
ä½¿ç”¨ç®€å•ä½†æœ‰æ•ˆçš„çº¿æ€§åŒä½™ç”Ÿæˆå™¨:
```typescript
const rand = (offset: number) => (seed + offset) % 100;
```

### Seed Distribution
```
Base Seed: simpleHash(description) â†’ å›ºå®šéƒ¨åˆ†(å†³å®šç±»å‹)
Random Seed: Date.now() + Math.random() â†’ å˜åŒ–éƒ¨åˆ†(å†³å®šç»†èŠ‚)
Offset: ä¸åŒå‚æ•°ä½¿ç”¨ä¸åŒoffset â†’ ç‹¬ç«‹éšæœº
```

### Collision Avoidance
- ä½¿ç”¨100-500èŒƒå›´çš„offsetå€¼
- ä¸åŒç‰¹å¾ä½¿ç”¨ä¸åŒoffsetèŒƒå›´
- æ—¶é—´æˆ³ç¡®ä¿å…¨å±€å”¯ä¸€æ€§

## ğŸš€ Future Enhancements

å¯èƒ½çš„æ‰©å±•:
- [ ] æ›´å¤šå˜´å·´è¡¨æƒ… (10+ç§)
- [ ] é…ä»¶ç³»ç»Ÿ (å¸½å­/çœ¼é•œ/é¡¹é“¾)
- [ ] é¢œè‰²çªå˜ (å½©è™¹è‰²/æ¸å˜)
- [ ] åŠ¨ç”»å˜ä½“ (ç§»åŠ¨æ–¹å¼ä¸åŒ)
- [ ] ç¨€æœ‰ç‰¹å¾ (1%æ¦‚ç‡ç‰¹æ®Šè£…é¥°)

---

**Updated**: 2025-11-29  
**Version**: 2.0 with Full Randomization
